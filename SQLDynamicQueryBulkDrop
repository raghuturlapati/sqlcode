

DECLARE @TBL_NAME VARCHAR(50)
DECLARE @TBL_SCHEMA VARCHAR(50)
DECLARE @COL1EXISTS INT
DECLARE @COL2EXISTS INT
DECLARE @COL1NAME VARCHAR(50)
DECLARE @COL2NAME VARCHAR(50)
DECLARE @SQLOUT VARCHAR(MAX)
DECLARE @CONNAME VARCHAR(50)



SET @TBL_NAME = ''
SET @TBL_SCHEMA = 'YOURSCHEMA'
SET @COL1EXISTS = 0
SET @COL2EXISTS = 0
SET @COL1NAME = 'COL1'
SET @COL2NAME = 'COL2'
SET @CONNAME= ''


SET @SQLOUT= ''

DECLARE CUR CURSOR FOR

SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES
			WHERE TABLE_SCHEMA = @TBL_SCHEMA


OPEN CUR
FETCH NEXT FROM CUR INTO @TBL_NAME

WHILE @@FETCH_STATUS = 0
BEGIN


SELECT @COL1EXISTS = COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @TBL_NAME AND TABLE_SCHEMA = @TBL_SCHEMA AND COLUMN_NAME = @COL1NAME

SELECT @COL2EXISTS = COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @TBL_NAME AND TABLE_SCHEMA = @TBL_SCHEMA AND COLUMN_NAME = @COL2NAME

SELECT @CONNAME = NAME FROM SYS.DEFAULT_CONSTRAINTS WHERE PARENT_OBJECT_ID = OBJECT_ID(@TBL_SCHEMA+'.'+@TBL_NAME) AND PARENT_COLUMN_ID = (SELECT column_id FROM sys.columns 
WHERE NAME = @COL1NAME AND object_id = OBJECT_ID(@TBL_SCHEMA+'.'+@TBL_NAME))



IF @COL1EXISTS = 1 AND @COL2EXISTS = 1 

BEGIN
PRINT 'CURRENTLY Dropping Columns for TABLE '+@TBL_NAME+' ...'
SET @SQLOUT = 'ALTER TABLE '+@TBL_SCHEMA+'.'+@TBL_NAME+' DROP CONSTRAINT '+@CONNAME+' '+'ALTER TABLE '+@TBL_SCHEMA+'.'+@TBL_NAME+' DROP COLUMN '+@COL1NAME
+' '+'ALTER TABLE '+@TBL_SCHEMA+'.'+@TBL_NAME+' DROP COLUMN '+@COL2NAME
PRINT @SQLOUT
EXEC(@SQLOUT)


END


FETCH NEXT FROM CUR INTO @TBL_NAME


END


CLOSE CUR
DEALLOCATE CUR
